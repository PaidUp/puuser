- hosts: prod
  vars:
    workspace: /var/lib/jenkins/workspace/Prod_PUOrganization
  tasks:
  - name: Pull sources from the repository.
    git: 
      repo: git@github.com:PaidUp/PUOrganization.git
      dest: '{{ workspace }}'
      version: master
      force: yes

  - name: install node modules
    shell: npm install
    args:
      chdir: '{{ workspace }}'

  - name: NODE | Stop APP
    shell: pm2 stop organization
    args:
      chdir: '{{ workspace }}'
    ignore_errors: yes

  - name: NODE | Start APP
    shell: npm run deploy-prod
    args:
      chdir: '{{ workspace }}'
 